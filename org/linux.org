#+title: Linux Tricks
#+author: Tony Aldon

* Links
  [[https://github.com/jlevy/the-art-of-command-line][github: the art of command lines]]
  [[https://fr.wikipedia.org/wiki/POSIX][wikipedia: POSIX]]
  [[http://docopt.org/][docopt: cli description language]]
  [[https://link.springer.com/content/pdf/bbm\%3A978-1-4302-0137-3\%2F1.pdf][spinger: glossary of linux terms]]
  [[https://devhints.io/bash][devhints.io: bash scripting]]
* Info
  A command is either an executable program, a shell builtins, a shell
  function, or an alias. Also see, directory /usr/share/doc.

  type, which, help, man, apropos, whatis, wich, whereis
* Packages management
** linux packages
*** List available linux packages related to a regexp
		- Problem :: How can I list linux package related to a regexp?
		- Use ~apt-cache search~ command.
		- search performs a full text search on all available package lists for
           the POSIX regex pattern given
		- If you want to search linux packages related to emacs, run the
      command: 
			#+BEGIN_SRC bash
			apt-cache search emacs
      #+END_SRC
*** Show linux package information
		- Problem :: How can I show linux package information?
		- Use ~apt-cache show~ command.
		- Display the package records for the named packages.
		- If you want to show the information of the installed ~emacs~
      emacs package, run the command:
			#+BEGIN_SRC bash
			apt-cache show emacs
      #+END_SRC
*** Update list of available linux packages
		- Problem :: How can I update the list of available linux packages?
		- Use ~apt-get update~ command.
		- This command is used to resynchronize the package index files from
      their sources.
*** list of installed package
		- Problem :: How can I list the installed packages?
		- Use ~apt list~ command.
		- List package satifying certain criteria.
		- See examples [[https://linuxize.com/post/how-to-list-installed-packages-on-ubuntu/][list installed packages]].
		- If you want to list all installed packages, run the command:
			#+BEGIN_SRC bash
			apt list --installed
      #+END_SRC
		- If you want to check if the package ~emacs~ is install, run the
      command:
			#+BEGIN_SRC bash
			apt list --installed | grep emacs
      #+END_SRC
*** Install newest version of all packages
		- Problem :: How can I install newest version of all my packages?
		- Use ~apt-get upgrade~ command.
		- This command installs the newest versions of all packages
      currently installed on the system from the sources enumerated in
      /etc/apt/sources.list.
*** Install a new linux package
		- Problem :: How can I install a new linux package?
		- Use ~apt-get install~ command.
		- Install new one or more linux packages.
		- If you want to install ~emacs~, run the command:
			#+BEGIN_SRC bash
			apt-get install emacs
      #+END_SRC
*** Remove a linux package
		- Problem :: How can I remove a linux package?
		- Use ~apt-get remove~ command.
		- Remove linux packages. Note that removing a package leaves its
      configuration files on the system. 
		- If you want to remove ~emacs~, run the command:
			#+BEGIN_SRC bash
			apt-get remove emacs
      #+END_SRC
** other packages
*** Managne ~nodejs~ packages
		npm
*** Manage ~python~ packages
		pip
* Environment variables
  ifconfig,
  whoami,
	see command ~printenv~.
* Users and groups
*** Run interactive shell as root
		- Problem :: How can I switch to root User?
		- Use ~su~ command.
		- Change user ID or become superuser.
		- See examples [[https://linuxize.com/post/su-command-in-linux/][su command]].
		- If you want to run an interactive shell as root, when root's
      password is already defined, run the command:
			#+BEGIN_SRC bash
			su
      #+END_SRC
		- If you want to run an interactive shell as root, when root's
      password is not defined, run the command:
			#+BEGIN_SRC bash
			sudo su -
			#+END_SRC
*** Enable root user account
		- Problem :: How can I enable root user account?
		- Use ~passwd~ command.
		- Change user password.
		- See examples [[https://linuxize.com/post/how-to-enable-and-disable-root-user-account-in-ubuntu/][root user account]].
		- If you want to enable the root user account and you have the
      sudo privileges, run the command:
			#+BEGIN_SRC bash
			sudo passwd root
      #+END_SRC
		- If you want to disable the root user account and you have the
      sudo privileges, run the command:
			#+BEGIN_SRC bash
			sudo passwd -l root
      #+END_SRC
*** to sort
  adduser, deluser, passwd
  addgroup, delgroup, usermod
  chown, chgrp
* Process and system
  lscpu, hostnamectl, top, ps
* Files
** View
   du, file, ls, cat, more, less, head, tail
** Links
   ln, stow, alias, unalias
** Compression/backup
   tar, zip, unzip, unrar, rsync, zcat, zmore, zless
** search
   locate, find, grep
*** find files
   - Problem :: How to find files that match string or regexp?
   - Use the command ~find~.
   - Search for files in a directory hierarchy.
	 - See examples [[https://alvinalexander.com/unix/edu/examples/find.shtml][example of command find]].
   - If you want to find files recursively from your ~$HOME~
     directory where the ~name~ match the global patern ~virtualenv*~,
     run the command:
     #+BEGIN_SRC bash
     find ~/ -name "virtualenv*"
     #+END_SRC
** Replace
*** replace string in multiple files
   - Problem :: How to replace string in multiple files?
   - Use commands ~sed~, ~perl~ and ~find~.
	 - Stream editor for filtering and transforming text (~sed~).
   - See examples here [[https://unix.stackexchange.com/questions/112023/how-can-i-replace-a-string-in-a-files][stackoverflow: replace string]].
	 - If you want to replace all occurrences of one string with another
     in all files in the current directory (Non recursive, files in
     this directory only.), run the command:
		 #+BEGIN_SRC bash
     sed -i -- 's/foo/bar/g' *
		 #+END_SRC
	 - If you want to replace all occurrences of one string with another
     in all files in the current directory (Recursive, regular files
     (including hidden ones) in this and all subdirectories), run the
     command:
		 #+BEGIN_SRC bash
		 find . -type f -exec sed -i 's/foo/bar/g' {} +
		 #+END_SRC
	 - If you want to replace only if the file name matches another
     string / has a specific extension / is of a certain type etc
     (Non-recursive, files in this directory only), run the command:
		 #+BEGIN_SRC bash
     sed -i -- 's/foo/bar/g' *baz*    # all files whose name contains baz
		 #+END_SRC
		- If you want to replace only if the file name matches another
     string / has a specific extension / is of a certain type etc
     (Non-recursive, files in this directory only), run the command:
		 #+BEGIN_SRC bash
		 find . -type f -name "*baz*" -exec sed -i 's/foo/bar/g' {} +
		 # all files whose name contains baz
		 #+END_SRC
** directories
   mkdir, cd, tree
* Network
  curl, wget, ping, ftp
** DNS
*** A record of an url
		- Problem :: How to get information of an ~url~ ?
		- Use the command ~dig~.
		- ~dig~ is a DNS lookup utility.
		- See examples [[https://support.dnsimple.com/articles/a-record/][A record]].
		- If you want to get the *A record* of ~youtube.com~, run the
			command:
			#+BEGIN_SRC bash
			dig A youtube.com
			#+END_SRC
** Host
*** IP address
		- Problem :: How can I know my IP address?
		- Use ~ifconfig~ command.
		- configure a network interface.
		- If you want to know your (local) IP address (use over the LAN),
      run the command:
			#+BEGIN_SRC bash
			ifconfig -a | grep -E 'inet '  # this is the local IP address
      #+END_SRC
		- If you want to know your (public) IP address (use over internet),
      follow the link  [[https://ifconfig.co/ip][ifconfig.co]] or run the command:
			#+BEGIN_SRC bash
			curl ifconfig.co
      #+END_SRC
** SSH
*** Enable SSH on ubuntu
		- Problem :: How can I to enable SSH (server) on ubuntu?
		- Use ~openssh-server~ package.
		- Secure shell (SSH) server, for secure access from remote machines.
		- See examples [[linkhttps://linuxize.com/post/how-to-enable-ssh-on-ubuntu-18-04/][enable ssh on ubuntu]].
		- If you want to enable SSH server on the standard port 22, you
      have to *start* ~ssh~ service with ~systemctl~ command and
      *allow* incomming SSH connection by *opening* (allowing) the
      port 22 with the command ~ufw~ and *enabling* the connection
      with the command ~ufw~. To do so, run the commands
			#+BEGIN_SRC bash
			sudo systemctl start ssh
			sudo ufw allow ssh  # or sudo ufw allow 22/tcp
			sudo ufw enable
      #+END_SRC
		- If you want to install ~openssh-server~ and *start* the service
      ~ssh~, run the command:
			#+BEGIN_SRC bash
      sudo apt install openssh-server
			#+END_SRC
*** Connecting to SSH
		- Problem :: How can I connect to my server via SSH?
		- Use ~ssh~ command.
		- OpenSSH SSH client (remote login program)
		- See examples [[https://linuxize.com/post/how-to-enable-ssh-on-ubuntu-18-04/][enable ssh on ubuntu]].
		- If you want to connect to your Ubuntu machine over LAN with
      ~bob~ as username and ~192.168.1.100~, run the command:
			#+BEGIN_SRC language
			ssh bob@192.168.1.100
      #+END_SRC
		- If you want to connect to your Ubuntu machine over Internet with
      ~bob~ as username and ~2a01:c50e:e911:9600:fc4d:b07d:d36f:6358~,
      run the command:
			#+BEGIN_SRC language
			ssh bob@2a01:c50e:e911:9600:fc4d:b07d:d36f:6358
      #+END_SRC
*** Connected to SSH server
		- Problem :: How can I know that my shell is connected via a SSH connection?
		- Use ~printenv~ command.
		- Print all or part of environment.
		- If you want to know if you're connected via SSH, check if the
      environment variables ~SSH_CONNECTION~, ~SSH_CLIENT~ and
      ~SSH_TTY~ are defined. To do so, run the command:
			#+BEGIN_SRC bash
			printenv | grep SSH
      #+END_SRC
*** Exit SSH session
		- Problem :: How can I exit a SSH connection?
		- Use ~exit~ command.
		- cause normal process termination
		- If you want to exit a SSH connection, you can either type ~C-d~
      or run the command:
			#+BEGIN_SRC bash
			exit
      #+END_SRC
** Servers
*** php server
		- Problem :: How to run a php server?
		- Use the command ~php~.
		- If the directory contains a ~index.php~ file, to have the server
			running on ~localhost~ on port ~8080~, run the command:
			#+BEGIN_SRC bash
			php -S localhost:8080
			#+END_SRC
*** Automatic reload server
		- Problem :: How to run a server that automatically reload when
                 files change on the system?
		- Use the command ~browser-sync~.
		- If the directory contains a ~index.html~ file, to have the server
			reload each second, run the command:
			#+BEGIN_SRC bash
			browser-sync start --reload-delay=1000 -w --server
			#+END_SRC
* Devices
  lsblk, mount, umount

  [[https://askubuntu.com/questions/37767/how-to-access-a-usb-flash-drive-from-the-terminal][usb flash drive: commnand line]]
  #+BEGIN_SRC bash
  lsblk  # find what the drive is called
  sudo mount /dev/sdb1 /mnt/  # if drive called sdb1
  sudo umount /mnt/
  #+END_SRC

* X window system
  xbindkey, xmodmap, xev, xdotools, wmctrl
* Date
  date, crontab, sleep, at, atq, atrm
* Images
** Use images
*** Wallpaper
		- Problem :: How to set the wallpaper?
		- Use the command ~feh~.
		- Image viewer and cataloguer.
		- See examples here [[https://wiki.archlinux.org/index.php/feh][wiki command feh]].
		- If you want ~path/to/images.jpg~ to be you be your image
			background, run the command:
			#+BEGIN_SRC bash
			feh --bg-fill path/to/images.jpg
			#+END_SRC
** Manipulate images
*** Convert images
		- Problem :: How to convert images?
		- Use the command ~convert~.
		- Convert  between  image  formats as well as resize an image.
		- See examples here [[https://www.howtogeek.com/109369/how-to-quickly-resize-convert-modify-images-from-the-linux-terminal/][howtogeek: convert image]].
		- If you want to convert the image ~image.png~ to the format
      ~jpg~, run the command:
			#+BEGIN_SRC bash
			convert image.png image.jpg
			#+END_SRC
		- If you want to install ~convert~, as it comes with the
      [[https://imagemagick.org/][imagemagick]] package, run the command:
			#+BEGIN_SRC bash
			sudo apt install imagemagick
			#+END_SRC
*** Resize an image
		- Problem :: How to resize an image?
		- Use the command ~convert~.
		- Convert  between  image  formats as well as resize an image.
		- See examples here [[https://www.howtogeek.com/109369/how-to-quickly-resize-convert-modify-images-from-the-linux-terminal/][howtogeek: convert image]].
		- If you want to resize an image to 200 pixels in width and 100
      pixels in heigh, run the command:
			#+BEGIN_SRC bash
			convert image.png -resize 200x100 image.png
			#+END_SRC
		- If you want to install ~convert~, as it comes with the
      [[https://imagemagick.org/][imagemagick]] package, run the command:
			#+BEGIN_SRC bash
			sudo apt install imagemagick
			#+END_SRC
* Backup
** Backup ~/etc~ directory
*** ~/etc~ stored in a ~git~ repository
		- Problem :: How can I review or revert changes that were made to ~/etc~?
		- Use ~etckeeper~ tool.
		- Store ~/etc~ in ~git~.
		- See examples [[https://etckeeper.branchable.com/README/][etckeeper README]].
		- If you want to install and initialize ~etckeeper~ on ubuntu,
      run the commands:
			#+BEGIN_SRC bash
			sudo apt install etckeeper
      #+END_SRC
		- If you want to ~commit~ changes made in ~/etc~ installing new
      package using ~apt~, do *nothing*, ~etckeeper~ do it for you.
		- If you want to ~commit~ changes made in ~/etc~, run the
      commands:
			#+BEGIN_SRC bash
      cd /etc
			sudo git add .  # or only a few files
			sudo git commit -m "your message"
			#+END_SRC
		- If you want to *configure* and tweak ~etckeeper~, see files and
      directories:
			- /etc/etckeeper/
			- /etc/etckeeper/etckeeper.conf
		- If you want to *skip* some files or directories from being
      stored into ~git~ repository, add them to ~/etc/.gitignore~.
		- If I want to *revert* changes to a previous state (commit), you
      must ~checkout~ to the previous commit and re-initialize
      ~etckeeper~, to do so run the commands:
			#+BEGIN_SRC bash
      sudo git checkout <previous-commit>
			sudo etckeeper init
			#+END_SRC
*** ~/etc~ backed up to ~usb~ drive
		- Problem :: How can I back up the ~/etc~ directory to ~usb~ drive?
		- Use ~rsync~ command.
		- A fast, versatile, remote (and local) file-copying tool
		- If you want to ???:
			#+BEGIN_SRC bash
			???
      #+END_SRC
		- Be aware that ~/etc~ directory contains secret informations. For
      instance, SHA-512 password are stored in the file
      ~/etc/shadow~.
* Sensitive actions
  rm, kill, killall, gparted
* Miscellaneous
  shutdown,
  reboot
  pandoc
  chmod
  sort
  wc
  uniq
  cut  csplit,
  split,
  iconv,
  diff,
  patch,
  man ascii,
  man utf-8,
  fpp (https://github.com/facebook/PathPicker),
  history,
  ffmpeg,
  xargs,
  ;,
  \&\&,
  \&,
  nohup,
  |,
  grip,
  pdflatex,
  pdftk,
  docker,
  source,
  dpkg,
  debootstrap
  >, > >, 2>, 2> >, 2>\&1, <, < <, |,
  uptime,
  tload
